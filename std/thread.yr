
extern (C) pthread_create (th : ptr!ulong, attr : ptr!void, fun : fn (ptr!void)->void, data : ptr!void);
extern (C) pthread_join (th : ulong, attr : ptr!void);

def thread (T) (fun : fn (T)->void, data) {
    let ret = 0UL;
    let aux = cast:fn (ptr!(void))->void (fun);
    pthread_create (&ret, null, aux, data.ptr);
    return ret;
}

def join (th : ulong) {
    pthread_join (th, null);
}

